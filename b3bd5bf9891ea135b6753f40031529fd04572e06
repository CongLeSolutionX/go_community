{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "b1026986_364a5bc5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 5305
      },
      "writtenOn": "2023-01-25T23:02:14Z",
      "side": 1,
      "message": "https://go.dev/cl/407414 changed ReverseProxy to add X-Forwarded-{Host,Proto} headers by default.\n\nhttps://go.dev/issue/57132 objected to this change, and the change was reverted in https://go.dev/cl/457595. (See the issue for some discussion and rationale on reverting.)\n\nGo 1.20 adds a new Rewrite hook to ReverseProxy, intended to address various limitations of Director hooks and superseding that hook. Programs using Rewrite can easily select their desired behavior for X-Forwarded headers:\n\n```\n// Overwrite existing X-Forwarded-* HTTP headers.\nRewrite: func(r *httputil.ProxyRequest) {\n  r.SetXForwarded()\n}\n```\n\n```\n// Add to existing X-Forwarded-* HTTP headers.\nRewrite: func(r *httputil.ProxyRequest) {\n  r.Out.Header[\"X-Forwarded-For\"] \u003d r.In.Header[\"X-Forwarded-For\"]\n  r.SetXForwarded()\n}\n```\n\n```\n// Preserve existing X-Forwarded-* HTTP headers.\nRewrite: func(r *httputil.ProxyRequest) {\n  r.Out.Header[\"X-Forwarded-For\"] \u003d r.In.Header[\"X-Forwarded-For\"]\n  r.Out.Header[\"X-Forwarded-Host\"] \u003d r.In.Header[\"X-Forwarded-Host\"]\n  r.Out.Header[\"X-Forwarded-Proto\"] \u003d r.In.Header[\"X-Forwarded-Proto\"]\n}\n```\n\nThanks for pushing support for X-Forwarded-Proto and X-Forwarded-Host forward.",
      "revId": "b3bd5bf9891ea135b6753f40031529fd04572e06",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    }
  ]
}