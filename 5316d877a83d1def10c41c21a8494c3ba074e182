{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "7b35ec6a_1ca323bb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 34507
      },
      "writtenOn": "2021-08-17T04:33:42Z",
      "side": 1,
      "message": "One downside with the approach I\u0027ve taken here is that while usually, the code is better, it appears to be worse for struct literals that would previously have been fully static via autotmps (which is true for at least fixedbugs/issue31782.go).\n\nIt feels like it should be possible to leave an OLINKSYMOFFSET node in the tree like ONAME for autotmp (they both should be knowable statically), but I haven\u0027t had much luck so far; doing so generates very strange code, so I\u0027m missing something.\n\nAnother option may be to teach anylit to understand OEFACE, maybe.",
      "revId": "5316d877a83d1def10c41c21a8494c3ba074e182",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5d6c92c6_94ffe5a2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 5200
      },
      "writtenOn": "2021-08-17T16:46:06Z",
      "side": 1,
      "message": "I\u0027d rather keep this code together with the code that does this in walk.\n\nThe tricky part is by the time we get to walk, the data we need to look at is already in an stmp. But we know how to look into an stmp, see cmd/compile/internal/ssa/rewrite.go:{symIsRO,readX}. Maybe that would be easier?\n",
      "revId": "5316d877a83d1def10c41c21a8494c3ba074e182",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "aa9ca884_a37d6b30",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 34507
      },
      "writtenOn": "2021-08-17T16:54:36Z",
      "side": 1,
      "message": "That\u0027s fair. It did feel a little wrong (and that\u0027s why I was looking at trying to get order to leave a OLINKSYMOFFSET node there, like it does with the new tmp).\n\nI\u0027ll try out grabbing the value out of the stmp, though I think that will limit this optimization to conversions outside of literals.",
      "parentUuid": "5d6c92c6_94ffe5a2",
      "revId": "5316d877a83d1def10c41c21a8494c3ba074e182",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "646f2acc_250b44d0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 34507
      },
      "writtenOn": "2021-08-17T17:52:47Z",
      "side": 1,
      "message": "-1-ing this myself while I work on this more.",
      "revId": "5316d877a83d1def10c41c21a8494c3ba074e182",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5435c9bd_51e659f4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 34507
      },
      "writtenOn": "2021-08-18T01:04:00Z",
      "side": 1,
      "message": "I\u0027ve tried out peering into ONAMEs and reading out their data, and that does actually work with a lot less code (everything is a byte already, so it doesn\u0027t need to do the decoding that ssa\u0027s read* funcs do), but the now-unused stmps persist in the -S output, so I\u0027m not sure that it gets the space savings.",
      "parentUuid": "aa9ca884_a37d6b30",
      "revId": "5316d877a83d1def10c41c21a8494c3ba074e182",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9e506e17_457f682d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 5200
      },
      "writtenOn": "2021-08-18T05:33:23Z",
      "side": 1,
      "message": "It should, if they are not referenced anywhere. The linker should discard them.",
      "parentUuid": "5435c9bd_51e659f4",
      "revId": "5316d877a83d1def10c41c21a8494c3ba074e182",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2ab61c64_0c01031c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 34507
      },
      "writtenOn": "2021-08-27T04:26:20Z",
      "side": 1,
      "message": "I\u0027ve updated a new patch set that grabs values out of the stmps.\n\nAfter some more thought, I\u0027m not sure if this is a good idea; I\u0027m basing this reading off of code in the SSA passes that can read out of the stmps, but, replacing them with new symbols that won\u0027t have those values, so some SSA passes may end up regressing.\n\nPerhaps this is done better still during SSA as some sort of rewrite, after the values have had a chance to be used?",
      "parentUuid": "9e506e17_457f682d",
      "revId": "5316d877a83d1def10c41c21a8494c3ba074e182",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    }
  ]
}