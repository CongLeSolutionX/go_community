{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "f1ac2ea1_a7fe9d61",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 9210
      },
      "writtenOn": "2024-11-19T01:09:55Z",
      "side": 1,
      "message": "Thanks for the reviews, I\u0027ll run the perf builders before submitting to be sure.",
      "revId": "3ff03feafc7cae23d70d14c1ca130da99dd90897",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "335790f3_0bf8bead",
        "filename": "src/runtime/lock_spinbit.go",
        "patchSetId": 3
      },
      "lineNbr": 185,
      "author": {
        "id": 5400
      },
      "writtenOn": "2024-11-19T08:11:02Z",
      "side": 1,
      "message": "Can we also remove this loop?\nIf we just do \"continue tryAcquire\" as we do everywhere else, it should have the same effect.",
      "fixSuggestions": [
        {
          "fixId": "6b790efd_821c8b05",
          "description": "prompt_to_edit API",
          "replacements": [
            {
              "path": "src/runtime/lock_spinbit.go",
              "range": {
                "startLine": 185,
                "startChar": 0,
                "endLine": 186,
                "endChar": 0
              },
              "replacement": "\t\tif v\u0026mutexLocked \u003d\u003d 0 {\n"
            },
            {
              "path": "src/runtime/lock_spinbit.go",
              "range": {
                "startLine": 203,
                "startChar": 0,
                "endLine": 203,
                "endChar": 0
              },
              "replacement": "\t\t\tcontinue tryAcquire\n"
            }
          ]
        }
      ],
      "revId": "3ff03feafc7cae23d70d14c1ca130da99dd90897",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c9830e06_4a211e5e",
        "filename": "src/runtime/lock_spinbit.go",
        "patchSetId": 3
      },
      "lineNbr": 185,
      "author": {
        "id": 9210
      },
      "writtenOn": "2024-11-19T17:53:31Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "335790f3_0bf8bead",
      "revId": "3ff03feafc7cae23d70d14c1ca130da99dd90897",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1643dfdd_88aad218",
        "filename": "src/runtime/lock_spinbit.go",
        "patchSetId": 3
      },
      "lineNbr": 188,
      "author": {
        "id": 5400
      },
      "writtenOn": "2024-11-19T08:11:02Z",
      "side": 1,
      "message": "We just want to keep mutexSleeping flag from the current state, right? Why do we add it, and then remove? Can\u0027t we do just:\n```\nnext :\u003d (v \u0026 ^mutexSpinning) | mutexLocked\n```\n?",
      "revId": "3ff03feafc7cae23d70d14c1ca130da99dd90897",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "db693667_5dd35f2e",
        "filename": "src/runtime/lock_spinbit.go",
        "patchSetId": 3
      },
      "lineNbr": 188,
      "author": {
        "id": 9210
      },
      "writtenOn": "2024-11-19T17:53:31Z",
      "side": 1,
      "message": "The fast path of lock2 clears that bit with its initial Xchg8, knowing that it will fix it in the slow path with a CAS like this. If we allow this thread to have cleared the sleeping bit and to not set it again it now, then this thread\u0027s unlock2 call will use the Xchg8-only fast path that doesn\u0027t load the full state word, and it won\u0027t wake the sleepers.",
      "parentUuid": "1643dfdd_88aad218",
      "revId": "3ff03feafc7cae23d70d14c1ca130da99dd90897",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "71b1bb18_8994a485",
        "filename": "src/runtime/lock_spinbit.go",
        "patchSetId": 3
      },
      "lineNbr": 188,
      "author": {
        "id": 5400
      },
      "writtenOn": "2024-11-20T06:22:05Z",
      "side": 1,
      "message": "Oh, I see. This deserves a comment, otherwise somebody will remove this logic later.",
      "parentUuid": "db693667_5dd35f2e",
      "revId": "3ff03feafc7cae23d70d14c1ca130da99dd90897",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    }
  ]
}