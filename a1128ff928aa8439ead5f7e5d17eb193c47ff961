{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "ec1c44d4_586616e0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 33992
      },
      "writtenOn": "2021-04-14T21:12:09Z",
      "side": 1,
      "message": "This is one of my first more \u0027complete\u0027 features for Go, so I\u0027m looking for your input on this PoC eg. if you think of a better way to achieve this.\n\nSome the questions/issues currently\n\n- There is a cyclical dependency between the `math/rand` and `testing` packages.\nI\u0027m thinking there are three solutions, but I\u0027m not sure which would be preferred.\na) use some other method to seed and shuffle the slices. Maybe use runtime.fastrand and a new shuffling function?\nb) //go:linkname the `rand.Seed` and `rand.Shuffle` functions so that they can be used here\nc) move the `math/rand` tests in a `rand_testing` package; this entails duplication of variables and making the tests less readable\n\n- I haven\u0027t used the JSON output very extensively, so I don\u0027t know if it would make sense to introduce a new Action in `test2json` for setting the seed\n\n- Are we okay with `-shuffle\u003don` using the system clock for seeding, or should we use a shorter/more readable seed?\n\n\nLooking forward to your input!\n",
      "revId": "a1128ff928aa8439ead5f7e5d17eb193c47ff961",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1cb3201f_750d4491",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5206
      },
      "writtenOn": "2021-04-14T21:56:21Z",
      "side": 1,
      "message": "Break the cyclical dependency between testing and math/rand by moving the math/rand tests into package rand_test.  The same pattern can be seen in pretty much every package that the testing package imports, such as the flag or os packages.\n\nI don\u0027t think anything different needs to appear in the JSON output.  The JSON output shouldn\u0027t care which order tests are run in.\n\nI think that the system clock is a good random seed.",
      "parentUuid": "ec1c44d4_586616e0",
      "revId": "a1128ff928aa8439ead5f7e5d17eb193c47ff961",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7f46a3cf_7aba705c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5137
      },
      "writtenOn": "2021-04-14T21:57:19Z",
      "side": 1,
      "message": "Thank you for working on this change Paschalis and congrats! I\u0027ve added some comments, please take a look.",
      "revId": "a1128ff928aa8439ead5f7e5d17eb193c47ff961",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0e024f44_2c8982ae",
        "filename": "src/cmd/go/internal/test/testflag.go",
        "patchSetId": 2
      },
      "lineNbr": 224,
      "author": {
        "id": 5137
      },
      "writtenOn": "2021-04-14T21:57:19Z",
      "side": 1,
      "message": "seed",
      "range": {
        "startLine": 224,
        "startChar": 1,
        "endLine": 224,
        "endChar": 2
      },
      "revId": "a1128ff928aa8439ead5f7e5d17eb193c47ff961",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6a5e9f8f_77f84e3a",
        "filename": "src/cmd/go/internal/test/testflag.go",
        "patchSetId": 2
      },
      "lineNbr": 230,
      "author": {
        "id": 5137
      },
      "writtenOn": "2021-04-14T21:57:19Z",
      "side": 1,
      "message": "Perhaps we should also return the error in here by:\n\n\nreturn fmt.Errorf(\"-shuffle argument must be \u0027on\u0027, \u0027off\u0027, or an int64: %v\", err)",
      "range": {
        "startLine": 230,
        "startChar": 70,
        "endLine": 230,
        "endChar": 72
      },
      "revId": "a1128ff928aa8439ead5f7e5d17eb193c47ff961",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6c2f9af4_fb0e07da",
        "filename": "src/testing/testing.go",
        "patchSetId": 2
      },
      "lineNbr": 1462,
      "author": {
        "id": 5137
      },
      "writtenOn": "2021-04-14T21:57:19Z",
      "side": 1,
      "message": "We need to properly parse -shuffle as you did for it in cmd/* and not ignore this error.\n\nThis code also unfortunately changes the global rand, perhaps make an *Rand by:\n\nseed, err :\u003d strconv.ParseInt(*shuffle, 10, 63)\nif err !\u003d nil {\n     // TODO: Handle the error here\n     m.exitCode \u003d 1\n     return\n}\nrng :\u003d math.New(math.NewSource(seed))\nrng.Shuffle(len(m.tests), func(i, j int) {\n     m.tests[i], m.tests[j] \u003d m.tests[j], m.tests[i]\n})\nrng.Shuffle(len(m.benchmarks), func(i, j int) {\n     m.benchmarks[i], m.benchmarks[j] \u003d m.benchmarks[j], m.benchmarks[i]\n})",
      "range": {
        "startLine": 1456,
        "startChar": 1,
        "endLine": 1462,
        "endChar": 2
      },
      "revId": "a1128ff928aa8439ead5f7e5d17eb193c47ff961",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    }
  ]
}