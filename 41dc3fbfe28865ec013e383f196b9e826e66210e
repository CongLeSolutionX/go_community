{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "85fef924_905c9aab",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5976
      },
      "writtenOn": "2023-05-16T19:29:15Z",
      "side": 1,
      "message": "TryBots beginning. Status page: https://farmer.golang.org/try?commit\u003d41dc3fbf\n",
      "tag": "autogenerated:trybots~beginning",
      "revId": "41dc3fbfe28865ec013e383f196b9e826e66210e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "767b4cd8_52543e52",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5976
      },
      "writtenOn": "2023-05-16T19:29:15Z",
      "side": 1,
      "message": "Superseded.",
      "parentUuid": "f6e34cd9_882d8a23",
      "tag": "autogenerated:trybots~beginning",
      "revId": "41dc3fbfe28865ec013e383f196b9e826e66210e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "aa83d6d4_10d854b9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5976
      },
      "writtenOn": "2023-05-16T19:39:54Z",
      "side": 1,
      "message": "TryBots are happy.\n\n",
      "parentUuid": "85fef924_905c9aab",
      "tag": "autogenerated:trybots~happy",
      "revId": "41dc3fbfe28865ec013e383f196b9e826e66210e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0575add2_02479c40",
        "filename": "src/cmd/gofmt/gofmt.go",
        "patchSetId": 2
      },
      "lineNbr": 468,
      "author": {
        "id": 6365
      },
      "writtenOn": "2023-05-17T18:34:32Z",
      "side": 1,
      "message": "I don\u0027t think we should remove `bakname` if we didn\u0027t succeed in restoring the original file contents.\n\nFor example, if we\u0027re writing to a network filesystem, we don\u0027t want to start writing the file, hit a transient error partway through due a network outage, and then have the network reconnect and succeed in removing the backup file.",
      "revId": "41dc3fbfe28865ec013e383f196b9e826e66210e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "98c37828_01cd172f",
        "filename": "src/cmd/gofmt/gofmt.go",
        "patchSetId": 2
      },
      "lineNbr": 468,
      "author": {
        "id": 5206
      },
      "writtenOn": "2023-05-17T18:57:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0575add2_02479c40",
      "revId": "41dc3fbfe28865ec013e383f196b9e826e66210e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d40de987_1bac52d4",
        "filename": "src/cmd/gofmt/gofmt.go",
        "patchSetId": 2
      },
      "lineNbr": 483,
      "author": {
        "id": 6365
      },
      "writtenOn": "2023-05-17T18:34:32Z",
      "side": 1,
      "message": "We should avoid `os.Rename` on even the failure paths, since that can change the owner/group/creation time/etc. to match the newly-created backup file instead of the original file, and can spuriously fail on Windows (such as if the file is currently held open by an AV scanner).\n\nInstead, we can open the file without `O_TRUNC` set (so that we don\u0027t lose the space for it if the disk is nearly full) and wait to truncate it until after the new contents have been written.\n\nThat is: I think the only purpose of the backup file should be to give the user something to restore manually in case `gofmt` is terminated before it can back out the changes properly.",
      "range": {
        "startLine": 481,
        "startChar": 0,
        "endLine": 483,
        "endChar": 30
      },
      "revId": "41dc3fbfe28865ec013e383f196b9e826e66210e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "165a7ae2_f065dfe6",
        "filename": "src/cmd/gofmt/gofmt.go",
        "patchSetId": 2
      },
      "lineNbr": 483,
      "author": {
        "id": 5206
      },
      "writtenOn": "2023-05-17T18:57:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d40de987_1bac52d4",
      "range": {
        "startLine": 481,
        "startChar": 0,
        "endLine": 483,
        "endChar": 30
      },
      "revId": "41dc3fbfe28865ec013e383f196b9e826e66210e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "daeff8f2_cc208513",
        "filename": "src/cmd/gofmt/gofmt.go",
        "patchSetId": 2
      },
      "lineNbr": 502,
      "author": {
        "id": 6365
      },
      "writtenOn": "2023-05-17T18:34:32Z",
      "side": 1,
      "message": "If we were to open the file without `O_TRUNC`, then I don\u0027t think we would need to bother with further restoration if `WriteAt` fails.\n\nThe original `Write` seems most likely to fail with either `ENOSPC`, or some other error on the first syscall. If it fails with `ENOSPC`, then the `WriteAt` is all but certain to write at least `n` bytes, which is enough to fix the file. If it fails due to some other error (such as the filesystem becoming completely unavailable, or a sandbox permission error), then the `Rename` attempts seem equally unlikely to succeed.",
      "range": {
        "startLine": 501,
        "startChar": 0,
        "endLine": 502,
        "endChar": 31
      },
      "revId": "41dc3fbfe28865ec013e383f196b9e826e66210e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bbea212f_e845fb32",
        "filename": "src/cmd/gofmt/gofmt.go",
        "patchSetId": 2
      },
      "lineNbr": 502,
      "author": {
        "id": 5206
      },
      "writtenOn": "2023-05-17T18:57:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "daeff8f2_cc208513",
      "range": {
        "startLine": 501,
        "startChar": 0,
        "endLine": 502,
        "endChar": 31
      },
      "revId": "41dc3fbfe28865ec013e383f196b9e826e66210e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3e24eb0e_15ff5fb1",
        "filename": "src/cmd/gofmt/gofmt.go",
        "patchSetId": 2
      },
      "lineNbr": 512,
      "author": {
        "id": 6365
      },
      "writtenOn": "2023-05-17T18:34:32Z",
      "side": 1,
      "message": "I\u0027m having a hard time imagining a case where the `Truncate` fails but the `Rename` succeeds. ðŸ˜…",
      "range": {
        "startLine": 510,
        "startChar": 0,
        "endLine": 512,
        "endChar": 14
      },
      "revId": "41dc3fbfe28865ec013e383f196b9e826e66210e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    }
  ]
}