{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "912a7ba0_4614932c",
        "filename": "src/go/build/deps_test.go",
        "patchSetId": 9
      },
      "lineNbr": 603,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T01:00:23Z",
      "side": 1,
      "message": "Don\u0027t need reflectlite any more?",
      "range": {
        "startLine": 603,
        "startChar": 8,
        "endLine": 603,
        "endChar": 28
      },
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a21f9931_b564e0c9",
        "filename": "src/go/build/deps_test.go",
        "patchSetId": 9
      },
      "lineNbr": 603,
      "author": {
        "id": 37653
      },
      "writtenOn": "2023-03-22T14:31:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "912a7ba0_4614932c",
      "range": {
        "startLine": 603,
        "startChar": 8,
        "endLine": 603,
        "endChar": 28
      },
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6487745e_a6ed1ddd",
        "filename": "src/maps/maps_test.go",
        "patchSetId": 9
      },
      "lineNbr": 187,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T01:00:23Z",
      "side": 1,
      "message": "This might be better inside the BenchmarkMapClone function instead of having this run even when just testing.\nYou can use b.ResetTimer after the initialization so it doesn\u0027t count towards the benchmark time or allocation metrics.",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "54c25fd9_8664b81d",
        "filename": "src/maps/maps_test.go",
        "patchSetId": 9
      },
      "lineNbr": 187,
      "author": {
        "id": 37653
      },
      "writtenOn": "2023-03-22T14:31:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6487745e_a6ed1ddd",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0051717b_9e5d7970",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1441,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T01:00:23Z",
      "side": 1,
      "message": "This will be easier to read, less indenting if you reverse the sense.\n\nif isEmpty(src.tophash[i])) {\n    continue\n}",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e2b27de6_7b8a1a64",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1441,
      "author": {
        "id": 37653
      },
      "writtenOn": "2023-03-22T14:31:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0051717b_9e5d7970",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0ab04ca1_d3a67d94",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1444,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T01:00:23Z",
      "side": 1,
      "message": "It\u0027s a bit strange to sometimes use the dst/src prefixes and sometimes not.\n\nEspecially because sometimes src is the default and sometimes dst is the default (eg. k/dstK here, but arraySize/srcArraySize below).\n\nIt would be better to be consistant and always use these prefixes when there\u0027s any confusion.",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1b83e804_64ac9d1e",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1444,
      "author": {
        "id": 37653
      },
      "writtenOn": "2023-03-22T14:31:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0ab04ca1_d3a67d94",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c2d3a705_3c17ae3d",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1458,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T01:00:23Z",
      "side": 1,
      "message": "This can allocate an overflow bucket but then never put anything in it.\nIt would be better to allocate this overflow only when you\u0027re about to put something in it. (Just before computing dstK above, probably.)",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6038f7da_7fb2f5c7",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1458,
      "author": {
        "id": 37653
      },
      "writtenOn": "2023-03-22T14:31:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c2d3a705_3c17ae3d",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1b65db4e_c7b4651f",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1474,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T01:00:23Z",
      "side": 1,
      "message": "s/not/no/",
      "range": {
        "startLine": 1474,
        "startChar": 62,
        "endLine": 1474,
        "endChar": 65
      },
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7e217290_62d13c9a",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1474,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T01:00:23Z",
      "side": 1,
      "message": "s/copy/copied/",
      "range": {
        "startLine": 1474,
        "startChar": 27,
        "endLine": 1474,
        "endChar": 31
      },
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4e779016_75d90a28",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1474,
      "author": {
        "id": 37653
      },
      "writtenOn": "2023-03-22T14:31:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7e217290_62d13c9a",
      "range": {
        "startLine": 1474,
        "startChar": 27,
        "endLine": 1474,
        "endChar": 31
      },
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "046df758_903938d2",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1474,
      "author": {
        "id": 37653
      },
      "writtenOn": "2023-03-22T14:31:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1b65db4e_c7b4651f",
      "range": {
        "startLine": 1474,
        "startChar": 62,
        "endLine": 1474,
        "endChar": 65
      },
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5015d229_f83f22cf",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1486,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T01:00:23Z",
      "side": 1,
      "message": "shouldn\u0027t this be i+j?\n\nDefinitely need a test for when the new map has less capacity than the old map.",
      "range": {
        "startLine": 1486,
        "startChar": 48,
        "endLine": 1486,
        "endChar": 49
      },
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "188b9699_f01608b0",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1486,
      "author": {
        "id": 37653
      },
      "writtenOn": "2023-03-22T14:31:50Z",
      "side": 1,
      "message": "Yes, you are right!",
      "parentUuid": "5015d229_f83f22cf",
      "range": {
        "startLine": 1486,
        "startChar": 48,
        "endLine": 1486,
        "endChar": 49
      },
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "104e262e_7e097adc",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1486,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T16:34:03Z",
      "side": 1,
      "message": "Still needs a test that exercises this.",
      "parentUuid": "188b9699_f01608b0",
      "range": {
        "startLine": 1486,
        "startChar": 48,
        "endLine": 1486,
        "endChar": 49
      },
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "47e88fc5_cf9b011a",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1495,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T01:00:23Z",
      "side": 1,
      "message": "Same here,\nif src.oldbuckets \u003d\u003d nil {\n   return dst\n}",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "127cb953_24c28159",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1495,
      "author": {
        "id": 37653
      },
      "writtenOn": "2023-03-22T14:31:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "47e88fc5_cf9b011a",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "330c53ba_059fd6a1",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1497,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T01:00:23Z",
      "side": 1,
      "message": "I don\u0027t think we can modify src in this function. Clone is a read operation, this Clone may be happening concurrently with other normal reads.",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1310105d_efbb0736",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1497,
      "author": {
        "id": 37653
      },
      "writtenOn": "2023-03-22T14:31:50Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "330c53ba_059fd6a1",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bfb2069e_84455a1e",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1507,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T01:00:23Z",
      "side": 1,
      "message": "This function is very similar to moveToBmap. Can we share the code somehow?",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d1f28fce_aac4ea2e",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1507,
      "author": {
        "id": 37653
      },
      "writtenOn": "2023-03-22T14:31:50Z",
      "side": 1,
      "message": "I will explain below.",
      "parentUuid": "bfb2069e_84455a1e",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ac5c953a_898442c7",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1521,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T01:00:23Z",
      "side": 1,
      "message": "I\u0027m not sure this is a problem. Any bucket which has not been evacuated can be copied completely, right?\nAny updated bucket during a grow will cause the old bucket to be evacuated and marked as such.\n\n(So I think we can just use moveToBmap with the main buckets and all unevacuated old buckets.)\n\n(This is more complicated in map iteration because we can have inserts in the middle of iterating through a bucket. That\u0027s not possible here.)",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "96c21d7a_281343c3",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1521,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T01:00:23Z",
      "side": 1,
      "message": "been overwritten",
      "range": {
        "startLine": 1521,
        "startChar": 57,
        "endLine": 1521,
        "endChar": 72
      },
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b25f920f_4e82de45",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1521,
      "author": {
        "id": 37653
      },
      "writtenOn": "2023-03-22T14:31:50Z",
      "side": 1,
      "message": "all the situation dst.B \u003c src.oldB, dst.B \u003d src.oldB and dst.B \u003e src.oldB  can be true, since we create a new map with src.count(adding deleteing). so the main bucket index of key in oldbucket may be change. so i think is a better choice to use mapassign here, what do you think about it?",
      "parentUuid": "ac5c953a_898442c7",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0258fc59_beec43ef",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1521,
      "author": {
        "id": 37653
      },
      "writtenOn": "2023-03-22T14:31:50Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "96c21d7a_281343c3",
      "range": {
        "startLine": 1521,
        "startChar": 57,
        "endLine": 1521,
        "endChar": 72
      },
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b8f12616_31d5a3ca",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1521,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T16:34:03Z",
      "side": 1,
      "message": "So I think I understand what you mean here. The problem is if dst.B \u003e src.oldB, we don\u0027t know which bucket an element should go to. We need one more bit of hash to decide that.\n\nSo yes, using mapassign to do that for us is fine.\n\n(We could test for dst.B \u003c\u003d src.oldB and use the faster copying method in that case, but let\u0027s save that for a possible followon CL.)\n\nDefinitely worth a comment in the code explaining this.",
      "parentUuid": "b25f920f_4e82de45",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1cff11cd_4efa24af",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1539,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T01:00:23Z",
      "side": 1,
      "message": "else if on one line\n\nOr even better, put this early on, like\n\nif src.count \u003d\u003d 0 {\n   return dst\n}\nif src.B \u003d\u003d 0 {\n   dst.buckets \u003d newobject(t.bucket)\n   ... typedmemmove ...\n   return dst\n}\n\nThat way the easier cases come earlier, and everything is indented less.",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "de1d7e72_1d0c7263",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1539,
      "author": {
        "id": 37653
      },
      "writtenOn": "2023-03-22T14:31:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1cff11cd_4efa24af",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2ef77eca_2ad5deab",
        "filename": "src/runtime/map.go",
        "patchSetId": 9
      },
      "lineNbr": 1539,
      "author": {
        "id": 5200
      },
      "writtenOn": "2023-03-22T16:34:03Z",
      "side": 1,
      "message": "Looks not done yet.",
      "parentUuid": "de1d7e72_1d0c7263",
      "revId": "b3870001104086d0119b76e1cc5f2e1ecd47a1e4",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    }
  ]
}