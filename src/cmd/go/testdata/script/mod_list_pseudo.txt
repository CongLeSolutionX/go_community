# Regression test for golang.org/issue/32715:
# When using $GOPATH/pkg/mod/cache/download as a proxy,
# 'latest' queries should prefer releases and pre-releases over pseudo-versions.

env GO111MODULE=on

go mod download github.com/dmitshur-test/modtest5@v0.0.0-20190619020302-197a620e0c9a
go mod download github.com/dmitshur-test/modtest5@v0.5.0-alpha
go mod download github.com/dmitshur-test/modtest5@v0.5.0-alpha.0.20190619023908-3da23a9deb9e
cmp $GOPATH/pkg/mod/cache/download/github.com/dmitshur-test/modtest5/@v/list $WORK/list

env GOPROXY=file:///$GOPATH/pkg/mod/cache/download
env GOPATH=$WORK/gopath2
mkdir $GOPATH

go list -m github.com/dmitshur-test/modtest5@latest
stdout 'github.com/dmitshur-test/modtest5 v0.5.0-alpha'

-- $WORK/list --
v0.0.0-20190619020302-197a620e0c9a
v0.5.0-alpha
v0.5.0-alpha.0.20190619023908-3da23a9deb9e
