# Issue #42565

[!cgo] skip

# Set CGO_LDFLAGS to a flag that is not normally permitted.
env CGO_LDFLAGS=-Wno-such-warning -Wno-unknown-warning-option

cd a
go build

cd ..
go build -ldflags=-v

# Because we passed -v the Go linker should print the external linker
# command which should include the flag we passed in CGO_LDFLAGS.
stderr no-such-warning

-- go.mod --
module ldflag

require my.pkg/ldflag/a v0.0.0

replace my.pkg/ldflag/a => ./a

-- a/go.mod --
module a

-- a/a.go --
package a

import "C"

-- main.go --
package main

import _ "my.pkg/ldflag/a"

func main() {}
