{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "c782e35e_9ca86993",
        "filename": "src/cmd/compile/internal/test/pgo_inl_test.go",
        "patchSetId": 10
      },
      "lineNbr": 34,
      "author": {
        "id": 6365
      },
      "writtenOn": "2023-10-16T17:32:27Z",
      "side": 1,
      "message": "Should these tests be skipped in short mode?\n\nIt looks like they end up rebuilding the full transitive dependencies of the `testing` package, and on some of the slower builders that adds nearly a minute (out of the test\u0027s ~3m default timeout under `dist test`):\nhttps://build.golang.org/log/7d0c56c0b0b6afa4f42c119849793370ddd94261",
      "revId": "3fb86fb8645ceb6163d1a9f573c2b4eec2a310f9",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "74e3ecdc_7358b97b",
        "filename": "src/cmd/compile/internal/test/pgo_inl_test.go",
        "patchSetId": 10
      },
      "lineNbr": 34,
      "author": {
        "id": 13315
      },
      "writtenOn": "2023-10-16T21:36:08Z",
      "side": 1,
      "message": "I don\u0027t think this should rebuild transitive dependencies. We pass `-gcflags\u003d-pgoprofile` to the current package, not `-gcflags\u003dall\u003d-pgoprofile`, not the go command\u0027s `-pgo` flag. If that rebuilds transitive dependencies, that would be a surprise to me.",
      "parentUuid": "c782e35e_9ca86993",
      "revId": "3fb86fb8645ceb6163d1a9f573c2b4eec2a310f9",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "74d9fbd3_c4365792",
        "filename": "src/cmd/compile/internal/test/pgo_inl_test.go",
        "patchSetId": 10
      },
      "lineNbr": 34,
      "author": {
        "id": 13315
      },
      "writtenOn": "2023-10-16T21:38:13Z",
      "side": 1,
      "message": "Oh maybe that is because we also pass `-trimpath` to the go command, which triggers a rebuild? Does `make.bash` now build things with `-trimpath`? If not, I can try passing `-gcflags\u003d-trimpath` instead, and see.",
      "parentUuid": "74e3ecdc_7358b97b",
      "revId": "3fb86fb8645ceb6163d1a9f573c2b4eec2a310f9",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4e40f63e_51272bca",
        "filename": "src/cmd/compile/internal/test/pgo_inl_test.go",
        "patchSetId": 10
      },
      "lineNbr": 34,
      "author": {
        "id": 13315
      },
      "writtenOn": "2023-10-17T02:58:28Z",
      "side": 1,
      "message": "Sent CL 535915. Thanks.",
      "parentUuid": "74d9fbd3_c4365792",
      "revId": "3fb86fb8645ceb6163d1a9f573c2b4eec2a310f9",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f0264043_632b9552",
        "filename": "src/cmd/compile/internal/test/pgo_inl_test.go",
        "patchSetId": 10
      },
      "lineNbr": 34,
      "author": {
        "id": 6365
      },
      "writtenOn": "2023-10-17T03:39:49Z",
      "side": 1,
      "message": "Hmm. `cmd/dist` sometimes builds `cmd` with `-trimpath`, but I don\u0027t think it ever runs tests with that flag. ðŸ¤”\n\nAt any rate: it seems kind of fragile to make any particular assumptions about what settings are used to build tests on the builders, since that could change over time (due to changes in `cmd/dist`) or per builder (due to `GOFLAGS` in the environment, maybe?).\n\nMaybe there is some other way to speed up compilation for the test? Or, barring that, is there really that much harm in skipping it in short mode? (Tests that invoke the linker tend to be much more expensive than those that only invoke the compiler, although 45s to build and link a test seems a little excessive even on a slow builder...)",
      "parentUuid": "4e40f63e_51272bca",
      "revId": "3fb86fb8645ceb6163d1a9f573c2b4eec2a310f9",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    }
  ]
}