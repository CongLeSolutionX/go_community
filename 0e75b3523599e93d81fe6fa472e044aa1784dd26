{
  "comments": [
    {
      "key": {
        "uuid": "657c761e_9c291a7f",
        "filename": "src/cmd/go/internal/modfetch/sumdb.go",
        "patchSetId": 1
      },
      "lineNbr": 238,
      "author": {
        "id": 6005
      },
      "writtenOn": "2019-06-22T00:00:28Z",
      "side": 1,
      "message": "Perhaps the typo was that \"download\" was added at all, and instead it should be removed rather than moved:\n\n    -targ :\u003d filepath.Join(PkgMod, \"download/cache/sumdb\", file)\n    +targ :\u003d filepath.Join(PkgMod, \"cache/sumdb\", file)\n\nThe $GOPATH/pkg/mod/cache directory currently has (at least) these top level entries:\n\n• download\n• lock\n• vcs\n\nWould sumdb be a better fit there?\n\nThe GOPATH/pkg/mod/cache/download directory is the local module cache, and so far, it has only contained modules.\n\nThe last paragraph of https://golang.org/cmd/go/#hdr-Module_proxy_protocol talks about copying its contents for the purposes of creating a static filesystem-based module proxy:\n\n\u003e serving $GOPATH/pkg/mod/cache/download at (or copying it to)\n\u003e https://example.com/proxy would let other users access those\n\u003e cached module versions with GOPROXY\u003dhttps://example.com/proxy.\n\n\"sumdb\" cannot conflict with a valid domain since there\u0027s no dot in it.",
      "revId": "0e75b3523599e93d81fe6fa472e044aa1784dd26",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a79beb1b_c8af90b4",
        "filename": "src/cmd/go/internal/modfetch/sumdb.go",
        "patchSetId": 1
      },
      "lineNbr": 238,
      "author": {
        "id": 17092
      },
      "writtenOn": "2019-06-26T17:22:16Z",
      "side": 1,
      "message": "I think I also prefer pkg/mod/cache/sumdb over pkg/mod/cache/download/sumdb.\n\nI don\u0027t think it\u0027s possible to serve GOSUMDB with a file:// URL as it is with GOPROXY, so it doesn\u0027t really matter where we cache these files. But it would be good to avoid putting extra files in a place GOPROXY\u003dfile://... might see them.",
      "parentUuid": "657c761e_9c291a7f",
      "revId": "0e75b3523599e93d81fe6fa472e044aa1784dd26",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0427b1dd_b4854dfc",
        "filename": "src/cmd/go/internal/modfetch/sumdb.go",
        "patchSetId": 1
      },
      "lineNbr": 238,
      "author": {
        "id": 6365
      },
      "writtenOn": "2019-06-26T17:24:26Z",
      "side": 1,
      "message": "I believe the intent is for GOPATH/pkg/mod/cache/download to be usable as a proxy, and as such it should contain any SUMDB contents that are relevant to proxy as well.\n\nI\u0027m surprised that there isn\u0027t a test case broken because of this somewhere in mod_file_proxy.txt or mod_sumdb_file_path.txt. Please ensure that at least one of those tests verifies this property.",
      "parentUuid": "657c761e_9c291a7f",
      "revId": "0e75b3523599e93d81fe6fa472e044aa1784dd26",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c3b0b054_6cd19c61",
        "filename": "src/cmd/go/internal/modfetch/sumdb.go",
        "patchSetId": 1
      },
      "lineNbr": 238,
      "author": {
        "id": 17090
      },
      "writtenOn": "2019-06-26T17:25:49Z",
      "side": 1,
      "message": "It is possible to serve a sumdb as a static filesystem, though you would need a lot of /lookup entries cached, and this is how you\u0027d do it. See https://go.googlesource.com/proposal/+/master/design/25530-sumdb.md#proxying-a-checksum-database.",
      "parentUuid": "a79beb1b_c8af90b4",
      "revId": "0e75b3523599e93d81fe6fa472e044aa1784dd26",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "496c2757_dcc4de3a",
        "filename": "src/cmd/go/internal/modfetch/sumdb.go",
        "patchSetId": 1
      },
      "lineNbr": 238,
      "author": {
        "id": 17092
      },
      "writtenOn": "2019-06-26T17:28:05Z",
      "side": 1,
      "message": "But I think it\u0027s not possible to serve it out of a directory in $GOPATH/pkg/mod. The layout is different, right? That\u0027s all I meant.",
      "parentUuid": "c3b0b054_6cd19c61",
      "revId": "0e75b3523599e93d81fe6fa472e044aa1784dd26",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bf0002bc_f15913b5",
        "filename": "src/cmd/go/internal/modfetch/sumdb.go",
        "patchSetId": 1
      },
      "lineNbr": 238,
      "author": {
        "id": 17090
      },
      "writtenOn": "2019-06-26T19:21:44Z",
      "side": 1,
      "message": "Added the test Bryan asked for, which took me longer to get working than I care to admit. It passes now and fails at the previous commit.",
      "parentUuid": "496c2757_dcc4de3a",
      "revId": "0e75b3523599e93d81fe6fa472e044aa1784dd26",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    }
  ]
}