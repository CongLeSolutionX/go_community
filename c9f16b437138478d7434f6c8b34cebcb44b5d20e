{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "ae6dae07_6e202e06",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5976
      },
      "writtenOn": "2022-03-08T23:31:07Z",
      "side": 1,
      "message": "TryBots beginning. Status page: https://farmer.golang.org/try?commit\u003dc9f16b43",
      "tag": "autogenerated:trybots~beginning",
      "revId": "c9f16b437138478d7434f6c8b34cebcb44b5d20e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c3b6551e_453653c9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5976
      },
      "writtenOn": "2022-03-08T23:43:44Z",
      "side": 1,
      "message": "TryBots are happy.\n\n",
      "parentUuid": "ae6dae07_6e202e06",
      "tag": "autogenerated:trybots~happy",
      "revId": "c9f16b437138478d7434f6c8b34cebcb44b5d20e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e2e7be1c_77ac25a6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5440
      },
      "writtenOn": "2022-03-09T00:04:57Z",
      "side": 1,
      "message": "Hm, I was just thinking though, this approach of requiring importers to be constructed with the Context means that we\u0027ll need to update all go/types users to construct the importer appropriately.\n\nIs it better to define a new Importer extension API that allows setting or passing the Context through?\n\nOr is it even necessary for the Importer to use the same Context as the source package? Can an Importer just create its own Context?",
      "revId": "c9f16b437138478d7434f6c8b34cebcb44b5d20e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "82796718_21c6b0ec",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5210
      },
      "writtenOn": "2022-03-10T05:44:45Z",
      "side": 1,
      "message": "@rfindley can you comment on the question below when you have a chance? Thanks.",
      "revId": "c9f16b437138478d7434f6c8b34cebcb44b5d20e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "098cdbfe_6c87a1e7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5210
      },
      "writtenOn": "2022-03-10T05:44:45Z",
      "side": 1,
      "message": "Sorry for the delayed reply. I\u0027m so tied up with the last remaining 1.18 issues.\n\nI think ideally the importer shares the context with the source package so that instantiated types can be shared if possible. I think we shouldn\u0027t rely on pointer identity though (but for one place where we know we probably have a bug; issue #51580). But I\u0027m not 100% sure. Should bring in @findleyr who knows the API better than I now.",
      "parentUuid": "e2e7be1c_77ac25a6",
      "revId": "c9f16b437138478d7434f6c8b34cebcb44b5d20e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a3ed4e67_a512497f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 31647
      },
      "writtenOn": "2022-03-10T12:16:43Z",
      "side": 1,
      "message": "Sorry also for my delayed response (I had draft comments... sigh)\n\nWe should not rely on pointer identity: Context should be considered purely an optimization. In that sense it\u0027s probably OK for importers to just create their own context.\n\n\u003e Is it better to define a new Importer extension API that allows setting or passing the Context through?\n\nYes, I think that is better: simply setting the Context on the types.Config should cause that Context to be used everywhere, including in Import. It is bound to be error prone if users have to pass the Context in both places.\n\nLet\u0027s start with creating a shared context in the importer, and then add a proposal for a new extension (ImportFromContext)?",
      "parentUuid": "098cdbfe_6c87a1e7",
      "revId": "c9f16b437138478d7434f6c8b34cebcb44b5d20e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "71ae8334_18353c8c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5440
      },
      "writtenOn": "2022-03-10T19:27:17Z",
      "side": 1,
      "message": "\u003e Let\u0027s start with creating a shared context in the importer, and then add a proposal for a new extension (ImportFromContext)?\n\nWhen you say \"creating a shared context in the importer,\" do you mean like CL 390958? Or something else?",
      "parentUuid": "a3ed4e67_a512497f",
      "revId": "c9f16b437138478d7434f6c8b34cebcb44b5d20e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ca2434b1_eaa267a7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 31647
      },
      "writtenOn": "2022-03-14T15:02:04Z",
      "side": 1,
      "message": "Sorry, I guess I don\u0027t understand the problem with the status quo. In CL 390958, it looks like we\u0027re already using a shared context. Why would we _not_ want to do that? What is the problem that we\u0027re trying to solve?",
      "parentUuid": "71ae8334_18353c8c",
      "revId": "c9f16b437138478d7434f6c8b34cebcb44b5d20e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4fa8a0a7_46f5fae5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5440
      },
      "writtenOn": "2022-03-14T16:17:51Z",
      "side": 1,
      "message": "Sorry, I wasn\u0027t sure what you meant by \"a shared context in the importer\" is all.\n\nI would describe the status quo as \"a single context shared between the importer and type checker.\" So \"a shared context in the importer\" sounds like it could mean \"a single context that\u0027s shared across packages imported by a single importer instance, but is separate from the one used by the type checker.\" But I infer now you meant the status quo.\n\nAnd I don\u0027t think we want CL 390958 per se. But I think we do want go/types users that write `types.Config{Importer: importer.Default()}` to still work. And CL 390958 demonstrates the constraint of allowing that to work: it needs to be possible to construct the importer and types.Config separately without any explicit types.Context plumbing.\n\nIn particular, if CL 390958 is already safe, then this CL can be made much less invasive: we only need to touch the go/internal/gcimporter files instead. So I just wanted to make sure that option was considered, in case that would make 1.18 cherry picking easier.",
      "parentUuid": "ca2434b1_eaa267a7",
      "revId": "c9f16b437138478d7434f6c8b34cebcb44b5d20e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ecd1e7e3_503a3ee4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 31647
      },
      "writtenOn": "2022-03-18T16:25:18Z",
      "side": 1,
      "message": "Per discussion, are you going to change this CL to instead add a new importer extension (and promote to this extension in go/types, types2)?",
      "revId": "c9f16b437138478d7434f6c8b34cebcb44b5d20e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4360e4b0_0ca265a3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5440
      },
      "writtenOn": "2022-03-18T19:13:05Z",
      "side": 1,
      "message": "Yeah. Marking as -2 for now; will either abandon or repurpose the CL once I have a chance to reassess. (Focusing for a bit on paying down other cmd/compile technical debt.)",
      "parentUuid": "ecd1e7e3_503a3ee4",
      "revId": "c9f16b437138478d7434f6c8b34cebcb44b5d20e",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    }
  ]
}