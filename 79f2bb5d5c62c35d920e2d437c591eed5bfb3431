{
  "comments": [
    {
      "key": {
        "uuid": "1558cfba_8d24d086",
        "filename": "src/runtime/trace.go",
        "patchSetId": 2
      },
      "lineNbr": 958,
      "author": {
        "id": 5190
      },
      "writtenOn": "2017-04-19T17:08:45Z",
      "side": 1,
      "message": "It seems too strict.\nIs it impossible to start tracing during sweep, so only traceGCSweepDone is called?",
      "range": {
        "startLine": 958,
        "startChar": 36,
        "endLine": 958,
        "endChar": 0
      },
      "revId": "79f2bb5d5c62c35d920e2d437c591eed5bfb3431",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4319e0d7_f4c08ef2",
        "filename": "src/runtime/trace.go",
        "patchSetId": 2
      },
      "lineNbr": 958,
      "author": {
        "id": 5167
      },
      "writtenOn": "2017-04-19T17:52:21Z",
      "side": 1,
      "message": "Why is this too strict? traceGCSweepStart() and traceGCSweepDone() must be paired (ideally just a few lines apart), which is exactly what this is checking for.",
      "parentUuid": "1558cfba_8d24d086",
      "range": {
        "startLine": 958,
        "startChar": 36,
        "endLine": 958,
        "endChar": 0
      },
      "revId": "79f2bb5d5c62c35d920e2d437c591eed5bfb3431",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1dc9e44a_ce551d91",
        "filename": "src/runtime/trace.go",
        "patchSetId": 2
      },
      "lineNbr": 958,
      "author": {
        "id": 5190
      },
      "writtenOn": "2017-04-19T18:06:32Z",
      "side": 1,
      "message": "Because it\u0027s not clear to me what makes it guaranteed to have traceGCSweepStart/Done always paired.\nI guess the answer is trace.enabled can\u0027t be set or reset during Sweep because StartTrace/StopTrace that mutate trace.enabled requires stopTheWorld before any mutation. And, while sweep is in progress, stopTheWorld can\u0027t proceed. Is it correct?",
      "parentUuid": "4319e0d7_f4c08ef2",
      "range": {
        "startLine": 958,
        "startChar": 36,
        "endLine": 958,
        "endChar": 0
      },
      "revId": "79f2bb5d5c62c35d920e2d437c591eed5bfb3431",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cc7ddde5_ab6acdee",
        "filename": "src/runtime/trace.go",
        "patchSetId": 2
      },
      "lineNbr": 958,
      "author": {
        "id": 5167
      },
      "writtenOn": "2017-04-19T18:11:38Z",
      "side": 1,
      "message": "That\u0027s right. I\u0027ve added a comment to this effect in the previous CL in this stack. Let me know if that clarifies things.",
      "parentUuid": "1dc9e44a_ce551d91",
      "range": {
        "startLine": 958,
        "startChar": 36,
        "endLine": 958,
        "endChar": 0
      },
      "revId": "79f2bb5d5c62c35d920e2d437c591eed5bfb3431",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "72f64109_edd2049f",
        "filename": "src/runtime/trace.go",
        "patchSetId": 2
      },
      "lineNbr": 963,
      "author": {
        "id": 5190
      },
      "writtenOn": "2017-04-19T17:08:45Z",
      "side": 1,
      "message": "to be safe, reset traceSwept and traceReclaimed",
      "range": {
        "startLine": 963,
        "startChar": 23,
        "endLine": 963,
        "endChar": 0
      },
      "revId": "79f2bb5d5c62c35d920e2d437c591eed5bfb3431",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "27ca5a1e_92a37c9d",
        "filename": "src/runtime/trace.go",
        "patchSetId": 2
      },
      "lineNbr": 963,
      "author": {
        "id": 5167
      },
      "writtenOn": "2017-04-19T17:52:21Z",
      "side": 1,
      "message": "What would this make more safe? Sweep could modify these anyway before the next traceGCSweepStart.",
      "parentUuid": "72f64109_edd2049f",
      "range": {
        "startLine": 963,
        "startChar": 23,
        "endLine": 963,
        "endChar": 0
      },
      "revId": "79f2bb5d5c62c35d920e2d437c591eed5bfb3431",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "77b7d210_1a7a96d4",
        "filename": "src/runtime/trace.go",
        "patchSetId": 2
      },
      "lineNbr": 963,
      "author": {
        "id": 5190
      },
      "writtenOn": "2017-04-19T18:06:32Z",
      "side": 1,
      "message": "This is again because I didn\u0027t assume the traceGCSweepStart/traceGCSweepDone are always paired. If they are always paird, yes, it doesn\u0027t make it more safe.",
      "parentUuid": "27ca5a1e_92a37c9d",
      "range": {
        "startLine": 963,
        "startChar": 23,
        "endLine": 963,
        "endChar": 0
      },
      "revId": "79f2bb5d5c62c35d920e2d437c591eed5bfb3431",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    }
  ]
}