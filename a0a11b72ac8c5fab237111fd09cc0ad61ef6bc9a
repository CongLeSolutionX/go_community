{
  "comments": [
    {
      "key": {
        "uuid": "08df39f7_8ba86409",
        "filename": "src/cmd/compile/internal/ssa/regalloc.go",
        "patchSetId": 32
      },
      "lineNbr": 474,
      "author": {
        "id": 13315
      },
      "writtenOn": "2018-05-17T14:03:54Z",
      "side": 1,
      "message": "Can/should we mark rematerializeable value on-stack in the init function?",
      "revId": "a0a11b72ac8c5fab237111fd09cc0ad61ef6bc9a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "af5def57_9c657fa9",
        "filename": "src/cmd/compile/internal/ssa/regalloc.go",
        "patchSetId": 32
      },
      "lineNbr": 474,
      "author": {
        "id": 13620
      },
      "writtenOn": "2018-05-18T22:13:47Z",
      "side": 1,
      "message": "See answer below.",
      "parentUuid": "08df39f7_8ba86409",
      "revId": "a0a11b72ac8c5fab237111fd09cc0ad61ef6bc9a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "38ebfe6f_b2b573ec",
        "filename": "src/cmd/compile/internal/ssa/regalloc.go",
        "patchSetId": 32
      },
      "lineNbr": 475,
      "author": {
        "id": 13315
      },
      "writtenOn": "2018-05-17T14:03:54Z",
      "side": 1,
      "message": "If v is already in the current block, maybe just return v.",
      "revId": "a0a11b72ac8c5fab237111fd09cc0ad61ef6bc9a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "84ab56ed_4b0919ab",
        "filename": "src/cmd/compile/internal/ssa/regalloc.go",
        "patchSetId": 32
      },
      "lineNbr": 475,
      "author": {
        "id": 13315
      },
      "writtenOn": "2018-05-18T14:58:22Z",
      "side": 1,
      "message": "I think we probably can return v anyway, no matter of whether it is in the same block. On-stack value is lazily generated, and it will be generated in different block if it is needed there. Is it right?\n\nIf this is true, and we mark rematerializeable value on-stack in the init function, then the next if block at line 480 will take care of it, and we don\u0027t need this if block.",
      "parentUuid": "38ebfe6f_b2b573ec",
      "revId": "a0a11b72ac8c5fab237111fd09cc0ad61ef6bc9a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ccd539b2_6871acff",
        "filename": "src/cmd/compile/internal/ssa/regalloc.go",
        "patchSetId": 32
      },
      "lineNbr": 475,
      "author": {
        "id": 13620
      },
      "writtenOn": "2018-05-18T22:13:47Z",
      "side": 1,
      "message": "I see what you\u0027re getting at, but this doesn\u0027t really seem clean to me. At minimum it would mess up the WasmStackSize safeguard.",
      "parentUuid": "84ab56ed_4b0919ab",
      "revId": "a0a11b72ac8c5fab237111fd09cc0ad61ef6bc9a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c26a80e8_4bdda3b5",
        "filename": "src/cmd/compile/internal/ssa/regalloc.go",
        "patchSetId": 32
      },
      "lineNbr": 475,
      "author": {
        "id": 13315
      },
      "writtenOn": "2018-05-21T18:28:26Z",
      "side": 1,
      "message": "\u003e At minimum it would mess up the WasmStackSize safeguard.\n\nIf I understand correctly I think the generated code is unchanged either way, so WasmStackSize is still valid.\n\nIt is fine to leave it as yours.",
      "parentUuid": "ccd539b2_6871acff",
      "revId": "a0a11b72ac8c5fab237111fd09cc0ad61ef6bc9a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9beef2c7_8ef86e05",
        "filename": "src/cmd/compile/internal/ssa/regalloc.go",
        "patchSetId": 32
      },
      "lineNbr": 475,
      "author": {
        "id": 13620
      },
      "writtenOn": "2018-05-23T01:10:16Z",
      "side": 1,
      "message": "WasmStackSize counts up at each Go assembly instruction that gets skipped because it is OnWasmStack. If we don\u0027t generate an additional instruction here, then we wouldn\u0027t count up.",
      "parentUuid": "c26a80e8_4bdda3b5",
      "revId": "a0a11b72ac8c5fab237111fd09cc0ad61ef6bc9a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "65bdf177_c1422b0d",
        "filename": "src/cmd/compile/internal/ssa/regalloc.go",
        "patchSetId": 32
      },
      "lineNbr": 499,
      "author": {
        "id": 13315
      },
      "writtenOn": "2018-05-18T14:58:22Z",
      "side": 1,
      "message": "It seems that nospill is used here as \"the value will be used (almost) immediately, so put it on stack\". This needs a comment. Or use a separate parameter.",
      "range": {
        "startLine": 499,
        "startChar": 59,
        "endLine": 499,
        "endChar": 66
      },
      "revId": "a0a11b72ac8c5fab237111fd09cc0ad61ef6bc9a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a7fb2dbf_a04b8304",
        "filename": "src/cmd/compile/internal/ssa/regalloc.go",
        "patchSetId": 32
      },
      "lineNbr": 499,
      "author": {
        "id": 13315
      },
      "writtenOn": "2018-05-18T14:58:22Z",
      "side": 1,
      "message": "Name it onWasmStack.",
      "range": {
        "startLine": 499,
        "startChar": 1,
        "endLine": 499,
        "endChar": 10
      },
      "revId": "a0a11b72ac8c5fab237111fd09cc0ad61ef6bc9a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6ddf52b7_f557442f",
        "filename": "src/cmd/compile/internal/ssa/regalloc.go",
        "patchSetId": 32
      },
      "lineNbr": 499,
      "author": {
        "id": 13620
      },
      "writtenOn": "2018-05-18T22:13:47Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a7fb2dbf_a04b8304",
      "range": {
        "startLine": 499,
        "startChar": 1,
        "endLine": 499,
        "endChar": 10
      },
      "revId": "a0a11b72ac8c5fab237111fd09cc0ad61ef6bc9a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "71f5c1f0_4062dea6",
        "filename": "src/cmd/compile/internal/ssa/regalloc.go",
        "patchSetId": 32
      },
      "lineNbr": 499,
      "author": {
        "id": 13620
      },
      "writtenOn": "2018-05-18T22:13:47Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "65bdf177_c1422b0d",
      "range": {
        "startLine": 499,
        "startChar": 59,
        "endLine": 499,
        "endChar": 66
      },
      "revId": "a0a11b72ac8c5fab237111fd09cc0ad61ef6bc9a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "29707653_adee54c9",
        "filename": "src/cmd/compile/internal/ssa/regalloc.go",
        "patchSetId": 32
      },
      "lineNbr": 503,
      "author": {
        "id": 5154
      },
      "writtenOn": "2018-05-17T14:39:41Z",
      "side": 1,
      "message": "It seems r and wasmStack not used in if statement below, so move it down to line 525?",
      "range": {
        "startLine": 498,
        "startChar": 1,
        "endLine": 503,
        "endChar": 2
      },
      "revId": "a0a11b72ac8c5fab237111fd09cc0ad61ef6bc9a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6398b0d0_0d43d2db",
        "filename": "src/cmd/compile/internal/ssa/regalloc.go",
        "patchSetId": 32
      },
      "lineNbr": 503,
      "author": {
        "id": 13620
      },
      "writtenOn": "2018-05-18T22:13:47Z",
      "side": 1,
      "message": "I tried this earlier and it didn\u0027t work, but now it does. Seems like something got untangled. Changed.",
      "parentUuid": "29707653_adee54c9",
      "range": {
        "startLine": 498,
        "startChar": 1,
        "endLine": 503,
        "endChar": 2
      },
      "revId": "a0a11b72ac8c5fab237111fd09cc0ad61ef6bc9a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5938476b_6064b503",
        "filename": "src/cmd/compile/internal/ssa/regalloc.go",
        "patchSetId": 32
      },
      "lineNbr": 503,
      "author": {
        "id": 13620
      },
      "writtenOn": "2018-05-19T13:05:33Z",
      "side": 1,
      "message": "I had to revert this to the way it was before. When moving these lines to 525, wasm works fine, but other architectures fail.",
      "parentUuid": "6398b0d0_0d43d2db",
      "range": {
        "startLine": 498,
        "startChar": 1,
        "endLine": 503,
        "endChar": 2
      },
      "revId": "a0a11b72ac8c5fab237111fd09cc0ad61ef6bc9a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "830ab090_7c031fdc",
        "filename": "src/cmd/compile/internal/ssa/regalloc.go",
        "patchSetId": 32
      },
      "lineNbr": 503,
      "author": {
        "id": 5154
      },
      "writtenOn": "2018-05-19T13:55:23Z",
      "side": 1,
      "message": "OK. Thank you for the investigation.",
      "parentUuid": "5938476b_6064b503",
      "range": {
        "startLine": 498,
        "startChar": 1,
        "endLine": 503,
        "endChar": 2
      },
      "revId": "a0a11b72ac8c5fab237111fd09cc0ad61ef6bc9a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    }
  ]
}