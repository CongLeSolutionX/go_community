{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "a9bfa300_018e1013",
        "filename": "src/cmd/go/internal/work/exec.go",
        "patchSetId": 4
      },
      "lineNbr": 2406,
      "author": {
        "id": 6365
      },
      "writtenOn": "2023-10-19T14:28:19Z",
      "side": 1,
      "message": "The comments / structure in `shellShared` seem to imply that the caller must acqure `printLock` before calling `fmtCmd`. Maybe rename it to `fmtCmdLocked` and add locking here?",
      "revId": "994c0772e5d07ed3226f0976fd7ecf7326e102ed",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "936f07d4_779636b3",
        "filename": "src/cmd/go/internal/work/exec.go",
        "patchSetId": 4
      },
      "lineNbr": 2406,
      "author": {
        "id": 5167
      },
      "writtenOn": "2023-10-19T14:45:56Z",
      "side": 1,
      "message": "This goes back to the race discovered in go.dev/cl/534857.\n\nI don\u0027t think locking just around fmtCmd is the answer because as soon as you drop that lock, the scriptDir could change before the output of fmtCmd is actually printed.\n\nI still think the best answer is that fmtCmd shouldn\u0027t consult scriptDir at all, and that Showcmd should be responsible for doing the scriptDir substitution. Optionally, we could also do scriptDir substitution on the desc passed to reportCmd (if it\u0027s not \"\").",
      "parentUuid": "a9bfa300_018e1013",
      "revId": "994c0772e5d07ed3226f0976fd7ecf7326e102ed",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c07d0417_0281a90c",
        "filename": "src/cmd/go/internal/work/exec.go",
        "patchSetId": 4
      },
      "lineNbr": 2406,
      "author": {
        "id": 5167
      },
      "writtenOn": "2023-10-19T16:21:00Z",
      "side": 1,
      "message": "Here\u0027s my proposed solution: go.dev/cl/536376\n\nIf that looks good, I can rebase this on top of that.",
      "parentUuid": "936f07d4_779636b3",
      "revId": "994c0772e5d07ed3226f0976fd7ecf7326e102ed",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8727d6e0_23934e96",
        "filename": "src/cmd/go/internal/work/exec.go",
        "patchSetId": 4
      },
      "lineNbr": 2406,
      "author": {
        "id": 5167
      },
      "writtenOn": "2023-10-19T17:37:36Z",
      "side": 1,
      "message": "Rebased. PTAL.",
      "parentUuid": "c07d0417_0281a90c",
      "revId": "994c0772e5d07ed3226f0976fd7ecf7326e102ed",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "934c062f_968e7139",
        "filename": "src/cmd/go/internal/work/shell.go",
        "patchSetId": 4
      },
      "lineNbr": 34,
      "author": {
        "id": 6365
      },
      "writtenOn": "2023-10-19T14:12:36Z",
      "side": 1,
      "message": "Please add a comment for the locking order between `mkdirLock` and `printLock`. (I believe that at the moment `mkdirLock` must be acquired first, because it is held during a call to `Showcmd` that acquires `printLock`.)",
      "revId": "994c0772e5d07ed3226f0976fd7ecf7326e102ed",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "41b6dd43_24f2ad8c",
        "filename": "src/cmd/go/internal/work/shell.go",
        "patchSetId": 4
      },
      "lineNbr": 34,
      "author": {
        "id": 5167
      },
      "writtenOn": "2023-10-19T14:45:56Z",
      "side": 1,
      "message": "With all this mess around mkdirLock, I just replaced it with a sync.Map. ðŸ˜„",
      "parentUuid": "934c062f_968e7139",
      "revId": "994c0772e5d07ed3226f0976fd7ecf7326e102ed",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    }
  ]
}