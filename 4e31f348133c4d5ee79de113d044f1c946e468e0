{
  "comments": [
    {
      "key": {
        "uuid": "715d4b31_c7445e3d",
        "filename": "src/sync/waitgroup.go",
        "patchSetId": 1
      },
      "lineNbr": 130,
      "author": {
        "id": 5055
      },
      "writtenOn": "2015-02-08T18:21:49Z",
      "side": 1,
      "message": "can\u0027t we use wg.sema \u003d\u003d nil for this and eliminate\nthe second bool field? (this will only save memory\non 32-bit int systems.)",
      "range": {
        "startLine": 130,
        "startChar": 5,
        "endLine": 130,
        "endChar": 15
      },
      "revId": "4e31f348133c4d5ee79de113d044f1c946e468e0",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3194b3fe_7dcaf7a5",
        "filename": "src/sync/waitgroup.go",
        "patchSetId": 1
      },
      "lineNbr": 130,
      "author": {
        "id": 5400
      },
      "writtenOn": "2015-02-08T18:26:27Z",
      "side": 1,
      "message": "No, we can\u0027t just use wg.sema\u003d\u003dnil.\nIt is set and reset multiple times, see \"wg.sema \u003d nil\" in Add.\n\nWhat we could do is to create a global\nvar alreadySignaled uint32\nand reset wg.sema to \u0026alreadySignaled instead of nil.\nThen Wait can do:\n\nif wg.sema \u003d\u003d nil {\n  wg.sema \u003d \u0026wg.sema0\n} else if wg.sema \u003d\u003d \u0026alreadySignaled {\n  wg.sema \u003d new(uint32)\n}\n\nAnd check in Add that we are not signaling on \u0026alreadySignaled just in case.\n\nDoes it sound good to you?",
      "parentUuid": "715d4b31_c7445e3d",
      "range": {
        "startLine": 130,
        "startChar": 5,
        "endLine": 130,
        "endChar": 15
      },
      "revId": "4e31f348133c4d5ee79de113d044f1c946e468e0",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    }
  ]
}