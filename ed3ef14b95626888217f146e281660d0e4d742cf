{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "93a09fd8_0e93579b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 6545
      },
      "writtenOn": "2023-11-07T10:06:31Z",
      "side": 1,
      "message": "Good cleanup. My observations aren\u0027t super important but I think some early rejections would make more sense.",
      "revId": "ed3ef14b95626888217f146e281660d0e4d742cf",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "85bdc43e_38e2de31",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 51461
      },
      "writtenOn": "2023-11-07T12:57:28Z",
      "side": 1,
      "message": "thanks you,Your advice is vital.",
      "parentUuid": "93a09fd8_0e93579b",
      "revId": "ed3ef14b95626888217f146e281660d0e4d742cf",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e6b24eac_8b24ef53",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 51461
      },
      "writtenOn": "2023-11-09T06:22:51Z",
      "side": 1,
      "message": "Do you have time to review my code?",
      "revId": "ed3ef14b95626888217f146e281660d0e4d742cf",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8b77cd47_bf446452",
        "filename": "src/internal/zstd/window.go",
        "patchSetId": 1
      },
      "lineNbr": 15,
      "author": {
        "id": 6545
      },
      "writtenOn": "2023-11-07T10:06:31Z",
      "side": 1,
      "message": "Window sizes above uint32 isn\u0027t within spec. Having a uint64 makes len() possibly truncate (and appendTo slightly strange). \n\nMaybe use uint32 throughout \u0027window\u0027 and check+cast when using reset?",
      "revId": "ed3ef14b95626888217f146e281660d0e4d742cf",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5bc330b3_9b65d539",
        "filename": "src/internal/zstd/window.go",
        "patchSetId": 1
      },
      "lineNbr": 15,
      "author": {
        "id": 51461
      },
      "writtenOn": "2023-11-07T12:57:28Z",
      "side": 1,
      "message": "In here it\u0027s like this https://datatracker.ietf.org/doc/html/rfc8878#section-3.1.1.1.2\n\n\u003e The Window_Descriptor byte is optional. When Single_Segment_Flag is set, Window_Descriptor is not present. In this case, Window_Size is Frame_Content_Size, which can be any value from 0 to 264 - 1 bytes (16 ExaBytes).\n\nSo I think I should use uint64, feel free to correct me.\n\nThe appendTo issue I really hadn\u0027t considered, what\u0027s his problem?",
      "parentUuid": "8b77cd47_bf446452",
      "revId": "ed3ef14b95626888217f146e281660d0e4d742cf",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f91c37b6_abc86cae",
        "filename": "src/internal/zstd/window.go",
        "patchSetId": 1
      },
      "lineNbr": 15,
      "author": {
        "id": 6545
      },
      "writtenOn": "2023-11-07T13:08:59Z",
      "side": 1,
      "message": "Yes. You are correct. I must\u0027ve misremembered since I have a default 1\u003c\u003c29 hard limit on window size.\n\nBut if you want to support it len() and appendTo would also need to be modified for this to make sense, as far as I can tell.",
      "parentUuid": "5bc330b3_9b65d539",
      "revId": "ed3ef14b95626888217f146e281660d0e4d742cf",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e35abaea_af7c4d90",
        "filename": "src/internal/zstd/window.go",
        "patchSetId": 1
      },
      "lineNbr": 15,
      "author": {
        "id": 51461
      },
      "writtenOn": "2023-11-09T02:53:49Z",
      "side": 1,
      "message": "This seems to avoid modifying len and appendTo if uint32 is used?\n\nDo you have a good suggestion? Currently it\u0027s to solve the problem of negative numbers in Windows size.",
      "parentUuid": "f91c37b6_abc86cae",
      "revId": "ed3ef14b95626888217f146e281660d0e4d742cf",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d1ccddad_bee18b2a",
        "filename": "src/internal/zstd/window.go",
        "patchSetId": 1
      },
      "lineNbr": 15,
      "author": {
        "id": 51461
      },
      "writtenOn": "2023-11-09T09:10:09Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e35abaea_af7c4d90",
      "revId": "ed3ef14b95626888217f146e281660d0e4d742cf",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ebf2946e_7024eec4",
        "filename": "src/internal/zstd/zstd.go",
        "patchSetId": 1
      },
      "lineNbr": 292,
      "author": {
        "id": 6545
      },
      "writtenOn": "2023-11-07T10:06:31Z",
      "side": 1,
      "message": "All of this is a bit weird, since you apply the 8M window max below.\n\nIf window size is \u003e8MB - and you don\u0027t want to decode that, then you should reject the decode at this point. It doesn\u0027t make sense to just set it to 8M and have it fail later.\n\nThat said the 8MB should probably be configurable if API is to be exposed publicly, since it may be overly restrictive for some uses.",
      "revId": "ed3ef14b95626888217f146e281660d0e4d742cf",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "905917bb_f2c188e3",
        "filename": "src/internal/zstd/zstd.go",
        "patchSetId": 1
      },
      "lineNbr": 292,
      "author": {
        "id": 51461
      },
      "writtenOn": "2023-11-09T06:22:51Z",
      "side": 1,
      "message": "Maybe just a simple treatment?",
      "parentUuid": "ebf2946e_7024eec4",
      "revId": "ed3ef14b95626888217f146e281660d0e4d742cf",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "33d25472_d1af6b79",
        "filename": "src/internal/zstd/zstd.go",
        "patchSetId": 1
      },
      "lineNbr": 292,
      "author": {
        "id": 51461
      },
      "writtenOn": "2023-11-09T09:10:09Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "905917bb_f2c188e3",
      "revId": "ed3ef14b95626888217f146e281660d0e4d742cf",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4e208c07_4db0a346",
        "filename": "src/internal/zstd/zstd.go",
        "patchSetId": 1
      },
      "lineNbr": 292,
      "author": {
        "id": 32637
      },
      "writtenOn": "2023-11-11T15:26:28Z",
      "side": 1,
      "message": "In the https://go-review.googlesource.com/c/go/+/531075 we also discussed that decoder should error on large window sizes instead of capping it.\n\nSince window is capped to 8MB anyways, I think there is no need to change window struct fields and other places and `r.window.reset(int(windowSize))` should be enough.",
      "parentUuid": "33d25472_d1af6b79",
      "revId": "ed3ef14b95626888217f146e281660d0e4d742cf",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "973a39e3_49b20a89",
        "filename": "src/internal/zstd/zstd.go",
        "patchSetId": 1
      },
      "lineNbr": 292,
      "author": {
        "id": 51461
      },
      "writtenOn": "2023-11-11T16:28:07Z",
      "side": 1,
      "message": "Thanks for the clarification, then this CL has a much simpler fix!",
      "parentUuid": "4e208c07_4db0a346",
      "revId": "ed3ef14b95626888217f146e281660d0e4d742cf",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705"
    }
  ]
}