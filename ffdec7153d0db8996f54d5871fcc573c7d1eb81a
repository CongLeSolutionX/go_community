{
  "comments": [
    {
      "key": {
        "uuid": "9fe25d53_bbf3741d",
        "filename": "src/cmd/go/internal/list/list.go",
        "patchSetId": 4
      },
      "lineNbr": 384,
      "author": {
        "id": 6365
      },
      "writtenOn": "2019-10-08T20:18:45Z",
      "side": 1,
      "message": "I discussed this some more with Russ, and he suggested that \u0027list -m\u0027 should either use the vendor directory by default (as \u0027list\u0027 without \u0027-m\u0027 does) or error out explicitly.\n\nSince the module list is incomplete (and therefore inconsistent with \u0027go mod graph\u0027) when reading from the vendor directory, I opted for making it an explicit failure, which I will implement in a separate CL.",
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "24fb1e63_0901e5ad",
        "filename": "src/cmd/go/internal/modcmd/vendor.go",
        "patchSetId": 4
      },
      "lineNbr": 42,
      "author": {
        "id": 17092
      },
      "writtenOn": "2019-10-02T17:03:30Z",
      "side": 1,
      "message": "As with go.mod and go.sum, we should check the go version in go.mod before writing vendor/modules.txt.\n\nWith this change, go1.13 may update modules.txt in a \u0027go 1.14\u0027 module, causing the consistency check to fail in go1.14. That\u0027s unfortunate, but we should avoid that in future versions.",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "afa5fa30_add248f4",
        "filename": "src/cmd/go/internal/modcmd/vendor.go",
        "patchSetId": 4
      },
      "lineNbr": 42,
      "author": {
        "id": 6365
      },
      "writtenOn": "2019-10-04T14:17:12Z",
      "side": 1,
      "message": "Good point, but I think it belongs in a separate CL. Let\u0027s discuss that as part of #34262.",
      "parentUuid": "24fb1e63_0901e5ad",
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f2775f16_ce2dcf13",
        "filename": "src/cmd/go/internal/modcmd/vendor.go",
        "patchSetId": 4
      },
      "lineNbr": 54,
      "author": {
        "id": 17092
      },
      "writtenOn": "2019-10-02T17:03:30Z",
      "side": 1,
      "message": "Is modHasPkgs[m] equivalent to len(modpkgs[m]) \u003e 0? If so, I think it would be clearer to just have a single map.",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "381ccdc6_541e2c0e",
        "filename": "src/cmd/go/internal/modcmd/vendor.go",
        "patchSetId": 4
      },
      "lineNbr": 54,
      "author": {
        "id": 6365
      },
      "writtenOn": "2019-10-04T14:17:12Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f2775f16_ce2dcf13",
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "186bd1a0_5855598d",
        "filename": "src/cmd/go/internal/modload/init.go",
        "patchSetId": 4
      },
      "lineNbr": 381,
      "author": {
        "id": 17092
      },
      "writtenOn": "2019-10-02T17:03:30Z",
      "side": 1,
      "message": "Move to the block of globals at the top of the function.\n\nMaybe rename to allowDefaultVendor?\n\nAlso, maybe drop DisableDefaultVendor and export this so commands can set it directly?",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f83fab58_76e249ad",
        "filename": "src/cmd/go/internal/modload/init.go",
        "patchSetId": 4
      },
      "lineNbr": 381,
      "author": {
        "id": 6365
      },
      "writtenOn": "2019-10-04T14:17:12Z",
      "side": 1,
      "message": "\u003e Move to the block of globals at the top of the function.\n\nDone.\n\n\u003e Maybe rename to allowDefaultVendor?\n\nDone.\n\n\u003e Also, maybe drop DisableDefaultVendor and export this so commands can set it directly?\n\nI would rather not: making the entry point a function makes it clear that the toggle only goes one way (from “enabled” to “disabled”), and also provides the opportunity to check invariants.\n\nAdded such a check.",
      "parentUuid": "186bd1a0_5855598d",
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c2c60fdd_43181ea8",
        "filename": "src/cmd/go/internal/modload/init.go",
        "patchSetId": 4
      },
      "lineNbr": 390,
      "author": {
        "id": 17092
      },
      "writtenOn": "2019-10-02T17:03:30Z",
      "side": 1,
      "message": "Is there any way to expose the implicit -mod\u003d value in \u0027go env\u0027? I expect we\u0027ll get some bug reports from confused users in this mode, and it would help us understand what\u0027s happening more quickly.",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d4de53b5_35166bac",
        "filename": "src/cmd/go/internal/modload/init.go",
        "patchSetId": 4
      },
      "lineNbr": 390,
      "author": {
        "id": 6365
      },
      "writtenOn": "2019-10-04T14:17:12Z",
      "side": 1,
      "message": "Maybe? But it\u0027s derivable from the Go version, GOMOD, and source layout.\n\nI\u0027m not opposed to adding that in the future, but if it\u0027s needed I would rather defer that to a separate CL, and perhaps get some buy-in on a name for the variable to report — would we report the default \"-mod\" flag, or the location of the detected vendor directory, or something else entirely?\n\nPerhaps we can address this holistically when we get to #33326.",
      "parentUuid": "c2c60fdd_43181ea8",
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c9dadd7a_a9f9a9db",
        "filename": "src/cmd/go/internal/modload/init.go",
        "patchSetId": 4
      },
      "lineNbr": 396,
      "author": {
        "id": 17092
      },
      "writtenOn": "2019-10-02T17:03:30Z",
      "side": 1,
      "message": "Should these commands set cfg.BuildMod \u003d \"mod\" themselves? This seems like an easy thing to forget when we add a new command or change how something works. It also can\u0027t cover \u0027go list -m\u0027.",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cf5e3eba_33120203",
        "filename": "src/cmd/go/internal/modload/init.go",
        "patchSetId": 4
      },
      "lineNbr": 396,
      "author": {
        "id": 6365
      },
      "writtenOn": "2019-10-04T14:17:12Z",
      "side": 1,
      "message": "This part of the init path is already very mutative. I really want to avoid having multiple points in the code that modify cfg.BuildMod in between flag parsing and other things.\n\n(Ideally I would like to do this whole analysis before parsing flags instead of after, but that\u0027s more refactoring than I want to take on right now — especially given that we shouldn\u0027t be statting the `vendor` directory if the `-mod` flag isn\u0027t even defined for the subcommand.)",
      "parentUuid": "c9dadd7a_a9f9a9db",
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f6aeecdb_ccc5b8f7",
        "filename": "src/cmd/go/internal/modload/init.go",
        "patchSetId": 4
      },
      "lineNbr": 402,
      "author": {
        "id": 17092
      },
      "writtenOn": "2019-10-02T17:03:30Z",
      "side": 1,
      "message": "I wonder if this is too subtle? I expect people will notice that vendor is enabled automatically in some projects but not others, and they won\u0027t realize it\u0027s because of \u0027go 1.14\u0027 in go.mod. Perhaps in pre-1.14 modules, \u0027go mod vendor\u0027 should print a warning that it won\u0027t be on by default.",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e12dd60c_931a7244",
        "filename": "src/cmd/go/internal/modload/init.go",
        "patchSetId": 4
      },
      "lineNbr": 402,
      "author": {
        "id": 6365
      },
      "writtenOn": "2019-10-04T14:17:12Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f6aeecdb_ccc5b8f7",
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c45fccc4_f4705a83",
        "filename": "src/cmd/go/internal/modload/init.go",
        "patchSetId": 4
      },
      "lineNbr": 410,
      "author": {
        "id": 17092
      },
      "writtenOn": "2019-10-02T17:03:30Z",
      "side": 1,
      "message": "The doc comment seems to imply cfg.BuildMod will not be empty after this function is called. It\u0027s fine to leave it empty or set to \"mod\", but maybe clarify in the comment.",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7c53adb8_7d472c39",
        "filename": "src/cmd/go/internal/modload/init.go",
        "patchSetId": 4
      },
      "lineNbr": 410,
      "author": {
        "id": 6365
      },
      "writtenOn": "2019-10-04T14:17:12Z",
      "side": 1,
      "message": "Seems simpler to document (and understand) if it always sets the value. Done.",
      "parentUuid": "c45fccc4_f4705a83",
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c8705a80_200ec216",
        "filename": "src/cmd/go/internal/modload/init.go",
        "patchSetId": 4
      },
      "lineNbr": 413,
      "author": {
        "id": 17092
      },
      "writtenOn": "2019-10-02T17:03:30Z",
      "side": 1,
      "message": "Unfinished comment?",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9a7d0e35_34ca658f",
        "filename": "src/cmd/go/internal/modload/init.go",
        "patchSetId": 4
      },
      "lineNbr": 413,
      "author": {
        "id": 6365
      },
      "writtenOn": "2019-10-04T14:17:12Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c8705a80_200ec216",
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "83cb1f3f_d4913821",
        "filename": "src/cmd/go/internal/modload/load.go",
        "patchSetId": 4
      },
      "lineNbr": 1041,
      "author": {
        "id": 17092
      },
      "writtenOn": "2019-10-02T17:03:30Z",
      "side": 1,
      "message": "It\u0027s unfortunate we aren\u0027t already using a structured format that is easier to extend. Ideally we would just add a few fields to a JSON blob. I can\u0027t really think of a simple way to switch formats now though without breaking compatibility with 1.13 or writing extra info to another file (vendor.mod?).\n\nSo probably nothing to do now, but let\u0027s think more seriously about this if we need to extend the format in the future beyond the new annotations.",
      "revId": "ffdec7153d0db8996f54d5871fcc573c7d1eb81a",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    }
  ]
}