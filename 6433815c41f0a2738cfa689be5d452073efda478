{
  "comments": [
    {
      "key": {
        "uuid": "7b2c080a_f5c6c169",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 5167
      },
      "writtenOn": "2017-09-01T14:17:35Z",
      "side": 1,
      "message": "s/pass/past/g",
      "revId": "6433815c41f0a2738cfa689be5d452073efda478",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "54189c78_14311352",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 13315
      },
      "writtenOn": "2017-09-01T16:47:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7b2c080a_f5c6c169",
      "revId": "6433815c41f0a2738cfa689be5d452073efda478",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "73e2c023_895edeba",
        "filename": "src/reflect/all_test.go",
        "patchSetId": 1
      },
      "lineNbr": 1555,
      "author": {
        "id": 5167
      },
      "writtenOn": "2017-09-01T14:17:35Z",
      "side": 1,
      "message": "past",
      "range": {
        "startLine": 1555,
        "startChar": 17,
        "endLine": 1555,
        "endChar": 21
      },
      "revId": "6433815c41f0a2738cfa689be5d452073efda478",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1414be95_b8e5efcc",
        "filename": "src/reflect/all_test.go",
        "patchSetId": 1
      },
      "lineNbr": 1555,
      "author": {
        "id": 13315
      },
      "writtenOn": "2017-09-01T16:47:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "73e2c023_895edeba",
      "range": {
        "startLine": 1555,
        "startChar": 17,
        "endLine": 1555,
        "endChar": 21
      },
      "revId": "6433815c41f0a2738cfa689be5d452073efda478",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e7765c86_ee445098",
        "filename": "src/reflect/all_test.go",
        "patchSetId": 1
      },
      "lineNbr": 1566,
      "author": {
        "id": 6365
      },
      "writtenOn": "2017-09-01T02:53:12Z",
      "side": 1,
      "message": "Can you trigger the bug in one iteration using a finalizer?\n\nvar finalized uint32\nf :\u003d func() (emptyStruct, *int) {\n  i :\u003d new(int)\n  runtime.SetFinalizer(i, func(*int) { atomic.StoreUint32(\u0026finalized, 1) })\n  return emptyStruct{}, i\n}\nv :\u003d ValueOf(f).Call([]Value{})[0]\nvar exhaust []*int\nfor atomic.LoadUint32(\u0026finalized) \u003d\u003d 0 {\n  runtime.GC()\n  exhaust \u003d append(exhaust, new(int)) // Force the GC to eventually run the finalizer.\n}\n\n\nThis program should terminate fairly quickly, but I believe that with the bug it will instead hang.",
      "range": {
        "startLine": 1560,
        "startChar": 0,
        "endLine": 1566,
        "endChar": 2
      },
      "revId": "6433815c41f0a2738cfa689be5d452073efda478",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c821f59a_36f48347",
        "filename": "src/reflect/all_test.go",
        "patchSetId": 1
      },
      "lineNbr": 1566,
      "author": {
        "id": 13315
      },
      "writtenOn": "2017-09-01T13:22:05Z",
      "side": 1,
      "message": "Thank you. As you said, this program indeed hangs before and finishes quickly after the fix. In my opinion, the old behavior isn\u0027t as bad, though. If the two return Value have the same pointer, it is a valid pointer and won\u0027t crash the GC, although it does prevent the int from being collected. So in some sense this is a stronger test. Do we want to ensure this behavior?",
      "parentUuid": "e7765c86_ee445098",
      "range": {
        "startLine": 1560,
        "startChar": 0,
        "endLine": 1566,
        "endChar": 2
      },
      "revId": "6433815c41f0a2738cfa689be5d452073efda478",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a95e1125_bac01963",
        "filename": "src/reflect/all_test.go",
        "patchSetId": 1
      },
      "lineNbr": 1566,
      "author": {
        "id": 5167
      },
      "writtenOn": "2017-09-01T14:17:35Z",
      "side": 1,
      "message": "In general I hate tests that depend on finalizers, but there\u0027s really no good way to test for these sorts of issues [1], so directly testing for the pointer aliasing using a finalizer might be the best we can do.\n\nI would put in a time out (see other finalizer tests), and you don\u0027t need the exhaust list (at least, currently, and a bunch of other tests will break if something like that does become necessary, so we\u0027ll fix them then).\n\n[1] I wonder if we should make one? I\u0027ve filed golang.org/issue/21730",
      "parentUuid": "c821f59a_36f48347",
      "range": {
        "startLine": 1560,
        "startChar": 0,
        "endLine": 1566,
        "endChar": 2
      },
      "revId": "6433815c41f0a2738cfa689be5d452073efda478",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "79f30dff_ec227610",
        "filename": "src/reflect/value.go",
        "patchSetId": 1
      },
      "lineNbr": 462,
      "author": {
        "id": 5167
      },
      "writtenOn": "2017-09-01T14:17:35Z",
      "side": 1,
      "message": "point",
      "range": {
        "startLine": 462,
        "startChar": 49,
        "endLine": 462,
        "endChar": 55
      },
      "revId": "6433815c41f0a2738cfa689be5d452073efda478",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "24c5594b_19b5675a",
        "filename": "src/reflect/value.go",
        "patchSetId": 1
      },
      "lineNbr": 462,
      "author": {
        "id": 13315
      },
      "writtenOn": "2017-09-01T16:47:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "79f30dff_ec227610",
      "range": {
        "startLine": 462,
        "startChar": 49,
        "endLine": 462,
        "endChar": 55
      },
      "revId": "6433815c41f0a2738cfa689be5d452073efda478",
      "serverId": "62eb7196-b449-3ce5-99f1-c037f21e1705",
      "unresolved": false
    }
  ]
}